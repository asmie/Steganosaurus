using System.Collections.Generic;
using System.Text;
using Xunit;

namespace libSteganography.Test
{

    public class SymmetricCryptoTests
    {

       public static IEnumerable<object[]> Data =>
       new List<object[]>
       {
            new object[] { new byte[] { 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x8, 0x9, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7 }, "1234567890123456", new byte[] { 0xe7, 0x31, 0x91, 0x72, 0x0a, 0xe8, 0x14, 0xa1, 0x7f, 0x80, 0x13, 0xe1, 0x2a, 0x09, 0x9a, 0x87, 0xbe, 0x37, 0x65, 0x46, 0x38, 0xc4, 0xdc, 0x23, 0xde, 0x38, 0xf5, 0x54, 0x39, 0x3a, 0xea, 0xe9 } },
            //new object[] { new byte[] { 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x8, 0x9, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x8 }, "1234567890123456", new byte[] { 0xe7, 0x31, 0x91, 0x72, 0x0a, 0xe8, 0x14, 0xa1, 0x7f, 0x80, 0x13, 0xe1, 0x2a, 0x09, 0x9a, 0x87, 0xbe, 0x37, 0x65, 0x46, 0x38, 0xc4, 0xdc, 0x23, 0xde, 0x38, 0xf5, 0x54, 0x39, 0x3a, 0xea, 0xe9 } },
            //new object[] { new byte[] { 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x8, 0x9, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x9 }, "1234567890123456", new byte[] { 0xe7, 0x31, 0x91, 0x72, 0x0a, 0xe8, 0x14, 0xa1, 0x7f, 0x80, 0x13, 0xe1, 0x2a, 0x09, 0x9a, 0x87, 0xbe, 0x37, 0x65, 0x46, 0x38, 0xc4, 0xdc, 0x23, 0xde, 0x38, 0xf5, 0x54, 0x39, 0x3a, 0xea, 0xe9 } },
            //new object[] { new byte[] { 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x8, 0x9, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x0 }, "1234567890123456", new byte[] { 0xe7, 0x31, 0x91, 0x72, 0x0a, 0xe8, 0x14, 0xa1, 0x7f, 0x80, 0x13, 0xe1, 0x2a, 0x09, 0x9a, 0x87, 0xbe, 0x37, 0x65, 0x46, 0x38, 0xc4, 0xdc, 0x23, 0xde, 0x38, 0xf5, 0x54, 0x39, 0x3a, 0xea, 0xe9 } },

       };

        [Theory]
        [MemberData(nameof(Data))]
        public void AESEncryptMemoryTestData(byte[] input, string key, byte[] expected)
        {
            var aes = new Crypto.SymmetricCrypto { };

            aes.Key = Encoding.UTF8.GetBytes(key);

            var output = aes.EncryptMemory(input);
            Assert.Equal(output.Length, expected.Length);
            Assert.Equal<byte[]>(output, expected);
        }
    }
}
